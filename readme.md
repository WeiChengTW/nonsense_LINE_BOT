# LineBot 使用說明書

本 LineBot 支援多種互動與管理功能，適合群組及個人聊天使用。以下為詳細使用說明，包含所有指令與操作方式。

---

## 功能列表與指令說明

| 指令             | 功能說明                                    |
| ---------------- | ------------------------------------------- |
| 你現在是甚麼模式 | 查詢目前 bot 的運作模式（聊天/靜音/亂說話） |
| 閉嘴             | bot 進入靜音模式，不再回覆訊息              |
| 聊天             | bot 解除靜音，恢復回覆訊息                  |
| 亂說話模式       | 啟用跨聊天室學習與回覆（狂暴模式）          |
| 乖寶寶模式       | 關閉亂說話模式，僅在本聊天室學習與回覆      |
| 學 A B           | 教 bot 收到「A」時回覆「B」                 |
| 你會說什麼       | 查詢本聊天室已教過 bot 的內容               |
| 壞壞             | 刪除 bot 上次學到的內容                     |
| 黃心如怎麼說     | 隨機回覆老師語錄（需預先設定資料）          |

---

## 指令詳解

### 查詢模式

- 輸入「你現在是甚麼模式」、「你現在是什麼模式」或「你現在什麼模式」可查詢 bot 是否在靜音或亂說話模式。

### 靜音/恢復聊天

- `閉嘴`：bot 進入靜音模式，暫停回覆。
- `聊天`：解除靜音，恢復正常回覆。

### 亂說話/乖寶寶模式

- `亂說話模式`：開啟後，bot 會跨聊天室學習與回覆（即所有群組共享學習內容）。
- `乖寶寶模式`：關閉亂說話模式，僅在本聊天室學習與回覆。

### 教學功能

- `學 A B`：教 bot 當收到「A」時，回覆「B」。  
   例如：「學 早安 早安你好」。
- `你會說什麼`：查詢本聊天室已教過 bot 的所有內容。

### 刪除學習內容

- `壞壞`：刪除 bot 上次回覆的學習內容，並回覆「下次不說 XXX 了」。

### 老師語錄

- `黃心如怎麼說`：隨機回覆預設的老師語錄（需於 `teacher.json` 設定語錄內容）。

---

## 特殊行為說明

- **重複訊息回覆**：同一群組內有多人同時說出相同訊息時，bot 會回覆該訊息，並清空該群組所有人的紀錄，避免洗版。
- **查詢內容**：在「亂說話模式」下，查詢會跨聊天室；在「乖寶寶模式」下，僅查詢本聊天室。

---

## 部署與運行

1. **安裝依賴：**
   ```bash
   pip install flask line-bot-sdk
   ```
2. **設定 LINE Channel Access Token 與 Secret，並於程式碼中填寫。**
3. **啟動伺服器：**
   ```bash
   python linebotserver.py
   ```
4. **設定 Webhook 至 `/callback` 路徑。**

---

## 檔案說明

- `data.json`：儲存學習內容
- `silent_mode.json`：儲存靜音狀態
- `rage_mode.json`：儲存亂說話模式狀態
- `user_last_message.json`：記錄用戶最後訊息
- `last_reply.json`：記錄上次回覆內容
- `teacher.json`：老師語錄資料（選用）

---

## 常見問題

- **格式錯誤**：「學」指令需為「學 A B」格式，否則會提示錯誤。
- **未設定語錄**：「黃心如怎麼說」若未設定語錄，會回覆「老師今天沒話說～」。
